# QKD 全局功耗优化回溯方案 (Branch & Bound)

## 1. 目标函数优化
- 目标：最小化所有请求的总功耗 $\sum_{i=1}^{N} Power_i$。
- 策略：将顺序分配转化为一个受限的树搜索问题。

## 2. 核心搜索机制
- **多路径分支**：修改 `find_min_weight_path_with_relay` 返回 Top-K 条候选路径（基于功耗排序）。
- **状态快照**：利用栈记录每一层请求处理前的拓扑和资源状态，支持精确的回滚（Rollback）。

## 3. 剪枝逻辑 (Pruning)
- **代价剪枝**：记录当前已发现的全局最低总功耗 `min_total_power_found`。
- **操作**：如果当前路径组合的累计功耗已超过 `min_total_power_found`，则立即回溯，放弃该分支。

## 4. 实施步骤
1. 修改 `find_min_weight_path_with_relay` 返回候选路径列表。
2. 在 `process_mid` 中实现带剪枝的深度优先搜索（DFS）逻辑。
3. 增加搜索广度（K值）和搜索深度限制，确保仿真在合理时间内完成。
4. 最终输出全局平均功耗最低的分配方案。
